## Predicting Left Ventricular Outflow Tract Obstruction 
Hypertrophic cardiomyopathy (HCM) affects 20 million individuals globally, with patients facing an increased risk of sudden death and heart failure. While cardiac myosin inhibitors show great promise as disease-specific treatment, current indications are for obstructive HCM. The primary method to diagnose LVOT obstruction is transthoracic echocardiography (TTE), which requires careful sonographer evaluation, additional imaging and Doppler measurements, and possible provocative maneuvers. Obstructive HCM is not always well characterized by echocardiography, with an underdiagnosis rate of nearly 90%<sup>1</sup>. Artificial intelligence may assist in the improving the underdiagnosis of left ventricular outflow tract (LVOT) obstruction. \
\
This repository offers a deep learning model that predicts the presence of LVOT obstruction using standard B-mode TTEs in the apical 4-chamber (A4C) view. When combined with clinical context, this model can identify patients who may benefit from more detailed evaluation for obstructive HCM.

<p align='center'>
  <img width="570" alt="model_schematic_with_examples" src="https://github.com/user-attachments/assets/1bec006d-c3bb-4733-acc5-9f0187534a4c" />
</p>


## Running Inference 
This script accepts a path to a directory containing A4C TTE echoes in DICOM format, and predicts the presence of left ventricular outflow tract (LVOT) obstruction. \
To run inference: 
1. Open utils.py and change the variable **weights_path** to the location of the model weights
<img width="693" alt="Screenshot 2025-03-06 at 1 11 47 PM" src="https://github.com/user-attachments/assets/24813a10-a1a0-4eb3-837d-49e98db5a055" />

2. Run the following command:\
    python predict_lvoto.py --data_path <path_to_directory>\
    where **--data_path** is the full path to a directory of DICOM files; files must be of A4C TTEs

Predictions are then saved to a .csv file in the directory from which the inference script is run. The predictions file contains 3 columns: 
1. filename - the name of the DICOM file
2. preds - the predictions of the deep learning model
3. pred_lvoto - 0 if no LVOT obstruction is detected versus 1 if obstruction is detected. Binary labels were generated by thresholding the values in the 'preds' column using a Youden index of 0.503

\
<sup>1</sup> Maron, B. J. et al. Diagnosis and evaluation of hypertrophic cardiomyopathy: JACC state-of-the-art review. J. Am. Coll. Cardiol. 79, 372–389 (2022)
